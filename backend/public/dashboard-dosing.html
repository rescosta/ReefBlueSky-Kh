

<!DOCTYPE html>
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dosadora Balling - ReefBlueSky</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
      color: #333;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header h1 {
      margin: 0;
      font-size: 24px;
    }

    .status-badge {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }

    .status-badge.online {
      background: rgba(0, 255, 0, 0.3);
      color: #00cc00;
    }

    .status-badge.offline {
      background: rgba(255, 0, 0, 0.3);
      color: #ff6666;
    }

    .nav-tabs {
      display: flex;
      border-bottom: 2px solid #ddd;
      margin-bottom: 20px;
      gap: 0;
    }

    .nav-tabs button {
      padding: 12px 20px;
      background: none;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      color: #666;
      transition: all 0.2s;
    }

    .nav-tabs button.active {
      color: #667eea;
      border-bottom-color: #667eea;
    }

    .nav-tabs button:hover {
      color: #667eea;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .card {
      background: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .card h2 {
      margin-top: 0;
      margin-bottom: 15px;
      font-size: 18px;
      border-bottom: 1px solid #eee;
      padding-bottom: 10px;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      font-size: 13px;
      color: #555;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 13px;
      font-family: inherit;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
    }

    .btn {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      transition: all 0.2s;
    }

    .btn-primary {
      background: #667eea;
      color: white;
    }

    .btn-primary:hover {
      background: #5568d3;
    }

    .btn-secondary {
      background: #f0f0f0;
      color: #333;
    }

    .btn-secondary:hover {
      background: #e0e0e0;
    }

    .btn-danger {
      background: #ff6b6b;
      color: white;
    }

    .btn-danger:hover {
      background: #ee5a5a;
    }

    .btn-small {
      padding: 4px 8px;
      font-size: 12px;
    }

    .pump-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .pump-card {
      background: #fafafa;
      border: 1px solid #eee;
      border-radius: 6px;
      padding: 15px;
    }

    .pump-card h3 {
      margin: 0 0 10px 0;
      font-size: 16px;
    }

    .pump-info {
      font-size: 12px;
      color: #666;
      margin-bottom: 10px;
      line-height: 1.6;
    }

    .volume-bar {
      width: 100%;
      height: 6px;
      background: #eee;
      border-radius: 3px;
      overflow: hidden;
      margin-bottom: 5px;
    }

    .volume-bar-fill {
      height: 100%;
      background: #667eea;
      border-radius: 3px;
    }

    .volume-bar-fill.low {
      background: #ff6b6b;
    }

    .volume-bar-fill.warning {
      background: #ffd93d;
    }

    .schedule-item {
      background: #f9f9f9;
      border-left: 3px solid #667eea;
      padding: 10px 12px;
      margin-bottom: 10px;
      border-radius: 4px;
      font-size: 12px;
    }

    .schedule-item.disabled {
      opacity: 0.6;
      border-left-color: #ccc;
    }

    .execution-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }

    .execution-table th,
    .execution-table td {
      padding: 8px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }

    .execution-table th {
      background: #f5f5f5;
      font-weight: 600;
      color: #555;
    }

    .status-ok {
      color: #00cc00;
      font-weight: 600;
    }

    .status-failed {
      color: #ff6666;
      font-weight: 600;
    }

    .status-skipped {
      color: #999;
    }

    .alert {
      padding: 12px 15px;
      border-radius: 4px;
      margin-bottom: 15px;
      font-size: 13px;
    }

    .alert-info {
      background: #e3f2fd;
      color: #1976d2;
      border-left: 3px solid #1976d2;
    }

    .alert-warning {
      background: #fff3e0;
      color: #f57c00;
      border-left: 3px solid #f57c00;
    }

    .alert-danger {
      background: #ffebee;
      color: #c62828;
      border-left: 3px solid #c62828;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }

    .form-row.full {
      grid-template-columns: 1fr;
    }

    @media (max-width: 768px) {
      .form-row {
        grid-template-columns: 1fr;
      }
      
      .header {
        flex-direction: column;
        gap: 10px;
      }
      
      .pump-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <!-- HEADER -->
  <div class="header">
    <div>
      <h1>游뛇 Dosadora Balling</h1>
      <p style="margin: 5px 0 0 0; font-size: 13px; opacity: 0.9;">Gerenciador de doses autom치ticas</p>
    </div>
    <div>
      <select id="deviceSelect" style="padding: 8px; border-radius: 4px; border: 1px solid #ccc;">
        <option value="">Selecionar device...</option>
      </select>
    </div>
  </div>

  <!-- TABS -->
  <div class="nav-tabs">
    <button class="tab-btn active" data-tab="dashboard">Dashboard</button>
    <button class="tab-btn" data-tab="devices">Devices</button>
    <button class="tab-btn" data-tab="pumps">Bombas</button>
    <button class="tab-btn" data-tab="schedules">Agendas</button>
    <button class="tab-btn" data-tab="executions">Hist칩rico</button>
  </div>

  <!-- TAB: DASHBOARD -->
  <div id="dashboard" class="tab-content active">
    <div class="pump-grid" id="pumpGridDashboard"></div>

    <div class="card">
      <h2>Alertas Recentes</h2>
      <div id="alertsList"></div>
    </div>

    <div class="card">
      <h2>Status do Sistema</h2>
      <div id="systemStatus"></div>
    </div>
  </div>

  <!-- TAB: DEVICES -->
  <div id="devices" class="tab-content">
    <div class="card">
      <h2>Meus Devices</h2>
      <div id="devicesList"></div>
      <hr style="margin: 20px 0;">
      <h3 style="margin-top: 0;">Adicionar Novo Device</h3>
      <form id="formAddDevice">
        <div class="form-row">
          <div class="form-group">
            <label>Nome do Device</label>
            <input type="text" id="newDeviceName" placeholder="Ex: Dosadora Principal" required>
          </div>
          <div class="form-group">
            <label>Tipo de Hardware</label>
            <select id="newDeviceType" required>
              <option value="ESP8266">ESP8266 (NodeMCU)</option>
              <option value="ESP32">ESP32</option>
            </select>
          </div>
        </div>
        <button type="submit" class="btn btn-primary">Criar Device</button>
      </form>
    </div>
  </div>

  <!-- TAB: PUMPS -->
  <div id="pumps" class="tab-content">
    <div class="card">
      <h2>Configurar Bombas</h2>
      <div id="pumpsList"></div>
      <hr style="margin: 20px 0;">
      <h3 style="margin-top: 0;">Adicionar Nova Bomba</h3>
      <form id="formAddPump">
        <div class="form-row">
          <div class="form-group">
            <label>Nome da Bomba</label>
            <input type="text" id="newPumpName" placeholder="Ex: KH" required>
          </div>
          <div class="form-group">
            <label>칈ndice (0-3)</label>
            <input type="number" id="newPumpIndex" min="0" max="3" required>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Volume Recipiente (mL)</label>
            <input type="number" id="newPumpContainer" value="500" required>
          </div>
          <div class="form-group">
            <label>Taxa Calibra칞칚o (mL/s)</label>
            <input type="number" id="newPumpCalibration" step="0.001" value="1.0" required>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Limite Alarme (%)</label>
            <input type="number" id="newPumpAlarmPct" value="10" required>
          </div>
          <div class="form-group">
            <label>M치ximo Di치rio (mL)</label>
            <input type="number" id="newPumpMaxDaily" value="100" required>
          </div>
        </div>
        <button type="submit" class="btn btn-primary">Adicionar Bomba</button>
      </form>
    </div>
  </div>

  <!-- TAB: SCHEDULES -->
  <div id="schedules" class="tab-content">
    <div class="card">
      <h2>Agendas de Dose</h2>
      <div id="schedulesList"></div>
      <hr style="margin: 20px 0;">
      <h3 style="margin-top: 0;">Adicionar Nova Agenda</h3>
      <form id="formAddSchedule">
        <div class="form-row">
          <div class="form-group">
            <label>Selecionar Bomba</label>
            <select id="schedulePumpId" required>
              <option value="">-- Selecione uma bomba --</option>
            </select>
          </div>
          <div class="form-group">
            <label>Doses por Dia</label>
            <input type="number" id="scheduleDosesPerDay" min="1" max="24" value="1" required>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Hor치rio In칤cio</label>
            <input type="time" id="scheduleStartTime" required>
          </div>
          <div class="form-group">
            <label>Hor치rio Fim</label>
            <input type="time" id="scheduleEndTime" required>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Volume Total Di치rio (mL)</label>
            <input type="number" id="scheduleVolumePerDay" value="36" required>
          </div>
        </div>
        <div class="form-group full">
          <label>Dias da Semana</label>
          <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
            <label><input type="checkbox" name="dayOfWeek" value="0" checked> Segunda</label>
            <label><input type="checkbox" name="dayOfWeek" value="1" checked> Ter칞a</label>
            <label><input type="checkbox" name="dayOfWeek" value="2" checked> Quarta</label>
            <label><input type="checkbox" name="dayOfWeek" value="3" checked> Quinta</label>
            <label><input type="checkbox" name="dayOfWeek" value="4" checked> Sexta</label>
            <label><input type="checkbox" name="dayOfWeek" value="5" checked> S치bado</label>
            <label><input type="checkbox" name="dayOfWeek" value="6" checked> Domingo</label>
          </div>
        </div>
        <button type="submit" class="btn btn-primary">Criar Agenda</button>
      </form>
    </div>
  </div>

  <!-- TAB: EXECUTIONS -->
  <div id="executions" class="tab-content">
    <div class="card">
      <h2>Hist칩rico de Doses</h2>
      <div style="margin-bottom: 15px;">
        <button class="btn btn-secondary btn-small" id="btnExportHistory">Exportar (CSV)</button>
      </div>
      <table class="execution-table" id="executionsTable">
        <thead>
          <tr>
            <th>Data/Hora</th>
            <th>Bomba</th>
            <th>Volume (mL)</th>
            <th>Status</th>
            <th>Origem</th>
          </tr>
        </thead>
        <tbody id="executionsBody">
          <tr><td colspan="5" style="text-align: center; color: #999;">Carregando...</td></tr>
        </tbody>
      </table>
    </div>
  </div>


  <script src="js/dashboard-common.js"></script>
  <script src="js/dashboard-dosing.js"></script>

</div>
</body>
</html>

